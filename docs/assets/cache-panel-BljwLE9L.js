import{s as z}from"./chunk-LvLJmgfZ.js";import{u as O}from"./useEvent-DlWF5OMa.js";import{t as A}from"./react-BGmjiNul.js";import"./react-dom-C9fstfnp.js";import{t as B}from"./compiler-runtime-DeeZ7FnK.js";import{t as R}from"./jsx-runtime-DN_bIXfG.js";import{t as P}from"./button-B8cGZzP5.js";import{t as G}from"./cn-C1rgT0yh.js";import{r as H}from"./requests-C0HaHO6a.js";import{t as _}from"./database-zap-CaVvnK_o.js";import{t as S}from"./spinner-C1czjtp7.js";import{t as F}from"./refresh-cw-Din9uFKE.js";import{t as K}from"./trash-2-C-lF7BNB.js";import{t as D}from"./use-toast-Bzf3rpev.js";import"./Combination-D1TsGrBC.js";import{a as q,c as J,i as Q,l as U,n as V,o as W,r as X,s as Y,t as Z,u as ee}from"./alert-dialog-jcHA5geR.js";import{t as se}from"./context-BAYdLMF_.js";import{r as m}from"./numbers-C9_R_vlY.js";import{n as te}from"./useAsyncData-Dj1oqsrZ.js";import{t as E}from"./empty-state-H6r25Wek.js";import{t as ae}from"./requests-bNszE-ju.js";var ie=B(),I=z(A(),1),s=z(R(),1);const re=i=>{let e=(0,ie.c)(27),{children:t,title:l,description:r,onConfirm:a,confirmText:c,cancelText:o,destructive:n}=i,y=c===void 0?"Continue":c,u=o===void 0?"Cancel":o,p=n===void 0?!1:n,[j,k]=I.useState(!1),f;e[0]===a?f=e[1]:(f=()=>{a(),k(!1)},e[0]=a,e[1]=f);let v=f,h=p?W:V,x;e[2]===t?x=e[3]:(x=(0,s.jsx)(ee,{asChild:!0,children:t}),e[2]=t,e[3]=x);let d;e[4]===l?d=e[5]:(d=(0,s.jsx)(U,{children:l}),e[4]=l,e[5]=d);let g;e[6]===r?g=e[7]:(g=(0,s.jsx)(q,{children:r}),e[6]=r,e[7]=g);let N;e[8]!==d||e[9]!==g?(N=(0,s.jsxs)(J,{children:[d,g]}),e[8]=d,e[9]=g,e[10]=N):N=e[10];let b;e[11]===u?b=e[12]:(b=(0,s.jsx)(X,{children:u}),e[11]=u,e[12]=b);let C;e[13]!==h||e[14]!==y||e[15]!==v?(C=(0,s.jsx)(h,{onClick:v,children:y}),e[13]=h,e[14]=y,e[15]=v,e[16]=C):C=e[16];let w;e[17]!==C||e[18]!==b?(w=(0,s.jsxs)(Y,{children:[b,C]}),e[17]=C,e[18]=b,e[19]=w):w=e[19];let $;e[20]!==w||e[21]!==N?($=(0,s.jsxs)(Q,{children:[N,w]}),e[20]=w,e[21]=N,e[22]=$):$=e[22];let M;return e[23]!==j||e[24]!==$||e[25]!==x?(M=(0,s.jsxs)(Z,{open:j,onOpenChange:k,children:[x,$]}),e[23]=j,e[24]=$,e[25]=x,e[26]=M):M=e[26],M};function L(i,e){if(i===0||i===-1)return"0 B";let t=1024,l=["B","KB","MB","GB","TB"],r=Math.floor(Math.log(i)/Math.log(t));return`${m(i/t**r,e)} ${l[r]}`}function le(i,e){if(i===0)return"0s";if(i<.001)return`${m(i*1e6,e)}\xB5s`;if(i<1)return`${m(i*1e3,e)}ms`;if(i<60)return`${m(i,e)}s`;let t=Math.floor(i/60),l=i%60;if(t<60)return l>0?`${t}m ${m(l,e)}s`:`${t}m`;let r=Math.floor(t/60),a=t%60;return a>0?`${r}h ${a}m`:`${r}h`}var oe=B(),ce=()=>{let{clearCache:i,getCacheInfo:e}=H(),t=O(ae),[l,r]=(0,I.useState)(!1),{locale:a}=se(),{isPending:c,isFetching:o,refetch:n}=te(async()=>{await e(),await new Promise(d=>setTimeout(d,500))},[]),y=async()=>{try{r(!0),await i(),D({title:"Cache purged",description:"All cached data has been cleared"}),n()}catch(d){D({title:"Error",description:d instanceof Error?d.message:"Failed to purge cache",variant:"danger"})}finally{r(!1)}};if(c&&!t)return(0,s.jsx)(S,{size:"medium",centered:!0});let u=(0,s.jsxs)(P,{variant:"outline",size:"sm",onClick:n,disabled:o,children:[o?(0,s.jsx)(S,{size:"small",className:"w-4 h-4 mr-2"}):(0,s.jsx)(F,{className:"w-4 h-4 mr-2"}),"Refresh"]});if(!t)return(0,s.jsx)(E,{title:"No cache data",description:"Cache information is not available.",icon:(0,s.jsx)(_,{}),action:u});let p=t.hits,j=t.misses,k=t.time,f=t.disk_total,v=t.disk_to_free,h=p+j,x=h>0?p/h*100:0;return h===0?(0,s.jsx)(E,{title:"No cache activity",description:"The cache has not been used yet. Cached functions will appear here once they are executed.",icon:(0,s.jsx)(_,{}),action:u}):(0,s.jsx)("div",{className:"flex flex-col h-full overflow-auto",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4 h-full",children:[(0,s.jsx)("div",{className:"flex items-center justify-end",children:(0,s.jsx)(P,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:n,disabled:o,children:(0,s.jsx)(F,{className:G("h-4 w-4 text-muted-foreground hover:text-foreground",o&&"animate-[spin_0.5s]")})})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Statistics"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(T,{label:"Time saved",value:le(k,a),description:"Total execution time saved"}),(0,s.jsx)(T,{label:"Hit rate",value:h>0?`${m(x,a)}%`:"\u2014",description:`${m(p,a)} hits / ${m(h,a)} total`}),(0,s.jsx)(T,{label:"Cache hits",value:m(p,a),description:"Successful cache retrievals"}),(0,s.jsx)(T,{label:"Cache misses",value:m(j,a),description:"Cache not found"})]})]}),f>0&&(0,s.jsxs)("div",{className:"space-y-3 pt-2 border-t",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-foreground",children:"Storage"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-3",children:(0,s.jsx)(T,{label:"Disk usage",value:L(f,a),description:v>0?`${L(v,a)} can be freed`:"Cache storage on disk"})})]}),(0,s.jsx)("div",{className:"my-auto"}),(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsx)(re,{title:"Purge cache?",description:"This will permanently delete all cached data. This action cannot be undone.",confirmText:"Purge",destructive:!0,onConfirm:y,children:(0,s.jsxs)(P,{variant:"outlineDestructive",size:"xs",disabled:l,className:"w-full",children:[l?(0,s.jsx)(S,{size:"small",className:"w-3 h-3 mr-2"}):(0,s.jsx)(K,{className:"w-3 h-3 mr-2"}),"Purge Cache"]})})})]})})},T=i=>{let e=(0,oe.c)(10),{label:t,value:l,description:r}=i,a;e[0]===t?a=e[1]:(a=(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:t}),e[0]=t,e[1]=a);let c;e[2]===l?c=e[3]:(c=(0,s.jsx)("span",{className:"text-lg font-semibold",children:l}),e[2]=l,e[3]=c);let o;e[4]===r?o=e[5]:(o=r&&(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:r}),e[4]=r,e[5]=o);let n;return e[6]!==a||e[7]!==c||e[8]!==o?(n=(0,s.jsxs)("div",{className:"flex flex-col gap-1 p-3 rounded-lg border bg-card",children:[a,c,o]}),e[6]=a,e[7]=c,e[8]=o,e[9]=n):n=e[9],n},ne=ce;export{ne as default};
