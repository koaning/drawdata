import{s as at}from"./chunk-LvLJmgfZ.js";import{t as ut}from"./react-BGmjiNul.js";import{t as ot}from"./compiler-runtime-DeeZ7FnK.js";import{t as it}from"./_baseIsEqual-Cz9Tt_-E.js";function $(t){return"init"in t}function q(t){return!!t.write}function B(t){return"v"in t||"e"in t}function R(t){if("e"in t)throw t.e;return t.v}var T=new WeakMap;function F(t){var e;return W(t)&&!!((e=T.get(t))!=null&&e[0])}function ft(t){let e=T.get(t);e!=null&&e[0]&&(e[0]=!1,e[1].forEach(n=>n()))}function O(t,e){let n=T.get(t);if(!n){n=[!0,new Set],T.set(t,n);let r=()=>{n[0]=!1};t.then(r,r)}n[1].add(e)}function W(t){return typeof(t==null?void 0:t.then)=="function"}function G(t,e,n){if(!n.p.has(t)){n.p.add(t);let r=()=>n.p.delete(t);e.then(r,r)}}function H(t,e,n){var l;let r=new Set;for(let a of((l=n.get(t))==null?void 0:l.t)||[])r.add(a);for(let a of e.p)r.add(a);return r}var st=(t,e,...n)=>e.read(...n),ct=(t,e,...n)=>e.write(...n),dt=(t,e)=>{if(e.INTERNAL_onInit)return e.INTERNAL_onInit(t);if(e.unstable_onInit)return console.warn("[DEPRECATED] atom.unstable_onInit is renamed to atom.INTERNAL_onInit."),e.unstable_onInit(t)},ht=(t,e,n)=>{var r;return(r=e.onMount)==null?void 0:r.call(e,n)},gt=(t,e)=>{var n;let r=w(t),l=r[0],a=r[6],u=r[9],f=l.get(e);return f||(f={d:new Map,p:new Set,n:0},l.set(e,f),(n=a.i)==null||n.call(a,e),u==null||u(t,e)),f},pt=t=>{let e=w(t),n=e[1],r=e[3],l=e[4],a=e[5],u=e[6],f=e[13],c=[],i=o=>{try{o()}catch(s){c.push(s)}};do{u.f&&i(u.f);let o=new Set,s=o.add.bind(o);r.forEach(d=>{var g;return(g=n.get(d))==null?void 0:g.l.forEach(s)}),r.clear(),a.forEach(s),a.clear(),l.forEach(s),l.clear(),o.forEach(i),r.size&&f(t)}while(r.size||a.size||l.size);if(c.length)throw AggregateError(c)},vt=t=>{let e=w(t),n=e[1],r=e[2],l=e[3],a=e[11],u=e[14],f=e[17],c=[],i=new WeakSet,o=new WeakSet,s=Array.from(l);for(;s.length;){let d=s[s.length-1],g=a(t,d);if(o.has(d)){s.pop();continue}if(i.has(d)){r.get(d)===g.n&&c.push([d,g]),o.add(d),s.pop();continue}i.add(d);for(let h of H(d,g,n))i.has(h)||s.push(h)}for(let d=c.length-1;d>=0;--d){let[g,h]=c[d],b=!1;for(let m of h.d.keys())if(m!==g&&l.has(m)){b=!0;break}b&&(u(t,g),f(t,g)),r.delete(g)}},yt=(t,e)=>{var n,r;let l=w(t),a=l[1],u=l[2],f=l[3],c=l[6],i=l[7],o=l[11],s=l[12],d=l[13],g=l[14],h=l[16],b=l[17],m=l[20],p=o(t,e);if(B(p)){if(a.has(e)&&u.get(e)!==p.n)return p;let y=!1;for(let[M,_]of p.d)if(g(t,M).n!==_){y=!0;break}if(!y)return p}p.d.clear();let v=!0;function S(){a.has(e)&&(b(t,e),d(t),s(t))}function N(y){var M;if(y===e){let U=o(t,y);if(!B(U))if($(y))m(t,y,y.init);else throw Error("no atom init");return R(U)}let _=g(t,y);try{return R(_)}finally{p.d.set(y,_.n),F(p.v)&&G(e,p.v,_),a.has(e)&&((M=a.get(y))==null||M.t.add(e)),v||S()}}let k,I,z={get signal(){return k||(k=new AbortController),k.signal},get setSelf(){return!I&&q(e)&&(I=(...y)=>{if(!v)try{return h(t,e,...y)}finally{d(t),s(t)}}),I}},V=p.n;try{let y=i(t,e,N,z);return m(t,e,y),W(y)&&(O(y,()=>k==null?void 0:k.abort()),y.then(S,S)),(n=c.r)==null||n.call(c,e),p}catch(y){return delete p.v,p.e=y,++p.n,p}finally{v=!1,V!==p.n&&u.get(e)===V&&(u.set(e,p.n),f.add(e),(r=c.c)==null||r.call(c,e))}},wt=(t,e)=>{let n=w(t),r=n[1],l=n[2],a=n[11],u=[e];for(;u.length;){let f=u.pop(),c=a(t,f);for(let i of H(f,c,r)){let o=a(t,i);l.set(i,o.n),u.push(i)}}},mt=(t,e,...n)=>{let r=w(t),l=r[3],a=r[6],u=r[8],f=r[11],c=r[12],i=r[13],o=r[14],s=r[15],d=r[16],g=r[17],h=r[20],b=!0,m=v=>R(o(t,v)),p=(v,...S)=>{var N;let k=f(t,v);try{if(v===e){if(!$(v))throw Error("atom not writable");let I=k.n,z=S[0];h(t,v,z),g(t,v),I!==k.n&&(l.add(v),s(t,v),(N=a.c)==null||N.call(a,v));return}else return d(t,v,...S)}finally{b||(i(t),c(t))}};try{return u(t,e,m,p,...n)}finally{b=!1}},Et=(t,e)=>{var g;var n;let r=w(t),l=r[1],a=r[3],u=r[6],f=r[11],c=r[15],i=r[18],o=r[19],s=f(t,e),d=l.get(e);if(d&&!F(s.v)){for(let[h,b]of s.d)if(!d.d.has(h)){let m=f(t,h);i(t,h).t.add(e),d.d.add(h),b!==m.n&&(a.add(h),c(t,h),(n=u.c)==null||n.call(u,h))}for(let h of d.d)s.d.has(h)||(d.d.delete(h),(g=o(t,h))==null||g.t.delete(e))}},bt=(t,e)=>{var n;let r=w(t),l=r[1],a=r[4],u=r[6],f=r[10],c=r[11],i=r[12],o=r[13],s=r[14],d=r[16],g=r[18],h=c(t,e),b=l.get(e);if(!b){s(t,e);for(let m of h.d.keys())g(t,m).t.add(e);b={l:new Set,d:new Set(h.d.keys()),t:new Set},l.set(e,b),q(e)&&a.add(()=>{let m=!0,p=(...v)=>{try{return d(t,e,...v)}finally{m||(o(t),i(t))}};try{let v=f(t,e,p);v&&(b.u=()=>{m=!0;try{v()}finally{m=!1}})}finally{m=!1}}),(n=u.m)==null||n.call(u,e)}return b},kt=(t,e)=>{var d,g;var n;let r=w(t),l=r[1],a=r[5],u=r[6],f=r[11],c=r[19],i=f(t,e),o=l.get(e);if(!o||o.l.size)return o;let s=!1;for(let h of o.t)if((d=l.get(h))!=null&&d.d.has(e)){s=!0;break}if(!s){o.u&&a.add(o.u),o=void 0,l.delete(e);for(let h of i.d.keys())(g=c(t,h))==null||g.t.delete(e);(n=u.u)==null||n.call(u,e);return}return o},St=(t,e,n)=>{let r=w(t)[11],l=r(t,e),a="v"in l,u=l.v;if(W(n))for(let f of l.d.keys())G(e,n,r(t,f));l.v=n,delete l.e,(!a||!Object.is(u,l.v))&&(++l.n,W(u)&&ft(u))},It=(t,e)=>{let n=w(t)[14];return R(n(t,e))},_t=(t,e,...n)=>{let r=w(t),l=r[12],a=r[13],u=r[16];try{return u(t,e,...n)}finally{a(t),l(t)}},At=(t,e,n)=>{let r=w(t),l=r[12],a=r[18],u=r[19],f=a(t,e).l;return f.add(n),l(t),()=>{f.delete(n),u(t,e),l(t)}},J=new WeakMap,w=t=>J.get(t);function Nt(t){let e=w(t),n=e[24];return n?n(e):e}function K(...t){let e={get(r){let l=w(e)[21];return l(e,r)},set(r,...l){let a=w(e)[22];return a(e,r,...l)},sub(r,l){let a=w(e)[23];return a(e,r,l)}},n=[new WeakMap,new WeakMap,new WeakMap,new Set,new Set,new Set,{},st,ct,dt,ht,gt,pt,vt,yt,wt,mt,Et,bt,kt,St,It,_t,At,void 0].map((r,l)=>t[l]||r);return J.set(e,Object.freeze(n)),e}var Mt=0;function Q(t,e){let n=`atom${++Mt}`,r={toString(){return n}};return typeof t=="function"?r.read=t:(r.init=t,r.read=Rt,r.write=Tt),e&&(r.write=e),r}function Rt(t){return t(this)}function Tt(t,e,n){return e(this,typeof n=="function"?n(t(this)):n)}var X;function C(){return X?X():K()}var Y;function Wt(){return Y||(Y=C()),Y}var E=at(ut(),1),D=(0,E.createContext)(void 0);function j(t){let e=(0,E.useContext)(D);return(t==null?void 0:t.store)||e||Wt()}function Ct({children:t,store:e}){let n=(0,E.useRef)(null);return e?(0,E.createElement)(D.Provider,{value:e},t):(n.current===null&&(n.current=C()),(0,E.createElement)(D.Provider,{value:n.current},t))}var L=t=>typeof(t==null?void 0:t.then)=="function",P=t=>{t.status||(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}))},jt=E.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(P(t),t)}),x=new WeakMap,Z=(t,e)=>{let n=x.get(t);return n||(n=new Promise((r,l)=>{let a=t,u=i=>o=>{a===i&&r(o)},f=i=>o=>{a===i&&l(o)},c=()=>{try{let i=e();L(i)?(x.set(i,n),a=i,i.then(u(i),f(i)),O(i,c)):r(i)}catch(i){l(i)}};t.then(u(t),f(t)),O(t,c)}),x.set(t,n)),n};function tt(t,e){let{delay:n,unstable_promiseStatus:r=!E.use}=e||{},l=j(e),[[a,u,f],c]=(0,E.useReducer)(o=>{let s=l.get(t);return Object.is(o[0],s)&&o[1]===l&&o[2]===t?o:[s,l,t]},void 0,()=>[l.get(t),l,t]),i=a;if((u!==l||f!==t)&&(c(),i=l.get(t)),(0,E.useEffect)(()=>{let o=l.sub(t,()=>{if(r)try{let s=l.get(t);L(s)&&P(Z(s,()=>l.get(t)))}catch{}if(typeof n=="number"){setTimeout(c,n);return}c()});return c(),o},[l,t,n,r]),(0,E.useDebugValue)(i),L(i)){let o=Z(i,()=>l.get(t));return r&&P(o),jt(o)}return i}function et(t,e){let n=j(e);return(0,E.useCallback)((...r)=>n.set(t,...r),[n,t])}function zt(t,e){return[tt(t,e),et(t,e)]}function Ot(t,e){return it(t,e)}var rt=Ot,Dt=ot();const A=C();async function Lt(t,e){return e(A.get(t))?A.get(t):new Promise(n=>{let r=A.sub(t,()=>{let l=A.get(t);e(l)&&(r(),n(l))})})}function Pt(t,e){let n=(0,Dt.c)(5),r=j(),l,a;n[0]!==t||n[1]!==e||n[2]!==r?(l=()=>{let u=r.get(t);r.sub(t,()=>{let f=r.get(t);e(f,u),u=f})},a=[t,e,r],n[0]=t,n[1]=e,n[2]=r,n[3]=l,n[4]=a):(l=n[3],a=n[4]),(0,E.useEffect)(l,a)}var nt=Symbol("sentinel");function xt(t,e=rt){let n=nt;return Q(r=>{let l=r(t);return(n===nt||!e(n,l))&&(n=l),n})}var Vt=typeof window<"u"?E.useInsertionEffect||E.useLayoutEffect:()=>{};function lt(t){let e=E.useRef(Ut);Vt(()=>{e.current=t},[t]);let n=E.useRef(null);return n.current||(n.current=function(){return e.current.apply(this,arguments)}),n.current}function Ut(){throw Error("INVALID_USEEVENT_INVOCATION: the callback from useEvent cannot be invoked before the component has mounted.")}var $t=lt;export{Pt as a,Ct as c,et as d,j as f,Nt as g,K as h,A as i,zt as l,C as m,$t as n,Lt as o,Q as p,xt as r,rt as s,lt as t,tt as u};
